{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://litlfred.github.io/notebooks/libraries/pq-torus/pq-torus/weierstrass/two-panel/widget.schema.json",
  "title": "Weierstrass Two-Panel Widget Schema",
  "description": "Schema for Weierstrass ℘(z) and ℘′(z) two-panel visualization widget instances",
  "type": "object",
  "properties": {
    "@context": {
      "type": ["array", "string", "object"],
      "description": "JSON-LD context"
    },
    "@id": {
      "type": "string",
      "description": "Widget instance identifier"
    },
    "@type": {
      "type": "array",
      "items": {"type": "string"},
      "description": "Widget type information"
    },
    "widget_id": {
      "type": "string",
      "description": "Unique widget instance ID"
    },
    "widget_type": {
      "type": "string",
      "enum": ["wp-two-panel", "wp-three-panel", "wp-five-panel", "wp-trajectories", "wp-contours"],
      "description": "Type of Weierstrass widget"
    },
    "input": {
      "$ref": "./input.schema.json",
      "description": "Widget input parameters"
    },
    "output": {
      "$ref": "./output.schema.json", 
      "description": "Widget output results"
    },
    "metadata": {
      "type": "object",
      "properties": {
        "created": {"type": "string", "format": "date-time"},
        "modified": {"type": "string", "format": "date-time"},
        "version": {"type": "string"},
        "author": {"type": "string"},
        "description": {"type": "string"}
      }
    },
    "dependencies": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "source_widget": {"type": "string"},
          "source_path": {"type": "string"},
          "target_path": {"type": "string"}
        }
      }
    },
    "layout": {
      "type": "object",
      "description": "Optional notebook layout information for blackboard positioning",
      "properties": {
        "position": {
          "type": "object",
          "description": "Widget position on infinite blackboard canvas",
          "properties": {
            "x": {"type": "number", "description": "X coordinate relative to origin"},
            "y": {"type": "number", "description": "Y coordinate relative to origin"}
          }
        },
        "size": {
          "type": "object",
          "description": "Widget display dimensions",
          "properties": {
            "width": {"type": "number", "minimum": 200, "maximum": 1200, "default": 350},
            "height": {"type": "number", "minimum": 150, "maximum": 800, "default": 250}
          }
        },
        "z_index": {
          "type": "integer",
          "description": "Widget stacking order",
          "minimum": 0,
          "default": 0
        },
        "locked": {
          "type": "boolean", 
          "description": "Whether widget position/size is locked",
          "default": false
        }
      }
    },
    "svg_visualization": {
      "type": "object",
      "description": "Optional SVG representation for widget visualization and edge routing",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Whether SVG visualization is enabled",
          "default": false
        },
        "widget_rect": {
          "type": "object",
          "description": "SVG rectangle coordinates for edge routing",
          "properties": {
            "x": {"type": "number", "description": "Top-left X coordinate in SVG space"},
            "y": {"type": "number", "description": "Top-left Y coordinate in SVG space"},
            "width": {"type": "number", "description": "Widget width in SVG space"},
            "height": {"type": "number", "description": "Widget height in SVG space"}
          }
        },
        "connection_ports": {
          "type": "object",
          "description": "Edge connection points for snap-to-arrowhead functionality",
          "properties": {
            "top": {"type": "array", "items": {"type": "number"}, "description": "X offsets for top edge connections"},
            "bottom": {"type": "array", "items": {"type": "number"}, "description": "X offsets for bottom edge connections"},
            "left": {"type": "array", "items": {"type": "number"}, "description": "Y offsets for left edge connections"},
            "right": {"type": "array", "items": {"type": "number"}, "description": "Y offsets for right edge connections"}
          }
        },
        "edge_routing": {
          "type": "object",
          "description": "Configuration for arrow edge routing and snapping",
          "properties": {
            "snap_to_border": {
              "type": "boolean",
              "description": "Whether arrowheads snap exactly to widget border",
              "default": true
            },
            "border_padding": {
              "type": "number",
              "description": "Padding from widget border for edge termination",
              "default": 2
            },
            "rounded_corner_support": {
              "type": "boolean",
              "description": "Support for rounded/non-rectangular borders",
              "default": false
            }
          }
        }
      }
    },
    "actions": {
      "type": "object",
      "description": "Available widget actions with localized names and icons",
      "patternProperties": {
        "^[a-z]+(-[a-z]+)*$": {
          "type": "object",
          "description": "Action definition with slug naming pattern",
          "properties": {
            "slug": {
              "type": "string",
              "pattern": "^[a-z]+(-[a-z]+)*$",
              "description": "Action identifier (lowercase letters and dashes)"
            },
            "names": {
              "type": "object",
              "description": "Localized human-readable action names",
              "patternProperties": {
                "^[a-z]{2}(-[A-Z]{2})?$": {"type": "string"}
              },
              "properties": {
                "en": {"type": "string"},
                "en-US": {"type": "string"},
                "es": {"type": "string"},
                "fr": {"type": "string"},
                "de": {"type": "string"}
              },
              "required": ["en"]
            },
            "icon": {
              "type": "string",
              "description": "Emoji or icon identifier for the action",
              "maxLength": 10
            },
            "description": {
              "type": "object",
              "description": "Localized action descriptions",
              "patternProperties": {
                "^[a-z]{2}(-[A-Z]{2})?$": {"type": "string"}
              },
              "properties": {
                "en": {"type": "string"}
              },
              "required": ["en"]
            },
            "menu_category": {
              "type": "string",
              "description": "Hierarchical menu category for hamburger menu",
              "default": "actions"
            },
            "output_format": {
              "type": "string",
              "enum": ["json", "html", "svg", "png", "pdf", "markdown"],
              "description": "Primary output format for this action",
              "default": "json"
            },
            "validation_required": {
              "type": "boolean",
              "description": "Whether input JSON schema validation is required before execution",
              "default": true
            }
          },
          "required": ["slug", "names", "icon"],
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    }
  },
  "required": ["widget_id", "widget_type"],
  "additionalProperties": false
}