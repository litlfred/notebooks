{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://litlfred.github.io/notebooks/schema/common.json",
  "title": "Common Widget Framework Schemas",
  "description": "Reusable schema definitions for the widget framework",
  "definitions": {
    "metadata": {
      "$id": "#/definitions/metadata",
      "type": "object",
      "title": "Widget Metadata",
      "description": "Common metadata properties for widgets",
      "properties": {
        "execution_time": {
          "type": "number",
          "description": "Execution time in milliseconds"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp of execution"
        },
        "widget_id": {
          "type": "string",
          "description": "Widget instance identifier"
        },
        "version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$",
          "description": "Widget version"
        }
      }
    },
    "execution_result": {
      "$id": "#/definitions/execution_result",
      "type": "object",
      "title": "Widget Execution Result",
      "description": "Standard execution result structure",
      "properties": {
        "success": {
          "type": "boolean",
          "description": "Whether execution succeeded"
        },
        "error": {
          "type": "string",
          "description": "Error message if execution failed"
        },
        "metadata": {
          "$ref": "#/definitions/metadata"
        }
      },
      "required": ["success"]
    },
    "markdown_content": {
      "$id": "#/definitions/markdown_content",
      "type": "object",
      "title": "Markdown Content Schema",
      "description": "Schema for markdown content with rendering options",
      "properties": {
        "content": {
          "type": "string",
          "description": "Markdown content",
          "default": ""
        },
        "render_latex": {
          "type": "boolean",
          "description": "Whether to render LaTeX math expressions",
          "default": true
        },
        "variables": {
          "type": "object",
          "description": "Variables for substitution in markdown",
          "patternProperties": {
            "^[a-zA-Z_][a-zA-Z0-9_]*$": {
              "type": ["string", "number", "boolean"]
            }
          },
          "additionalProperties": false,
          "default": {}
        }
      },
      "required": ["content"]
    },
    "visualization_output": {
      "$id": "#/definitions/visualization_output",
      "type": "object",
      "title": "Visualization Output Schema",
      "description": "Standard schema for widget visualization outputs",
      "properties": {
        "image_base64": {
          "type": "string",
          "pattern": "^data:image/[a-zA-Z]+;base64,",
          "description": "Base64 encoded image with data URI prefix"
        },
        "width": {
          "type": "integer",
          "minimum": 1,
          "description": "Image width in pixels"
        },
        "height": {
          "type": "integer",
          "minimum": 1,
          "description": "Image height in pixels"
        },
        "mime_type": {
          "enum": ["image/png", "image/jpeg", "image/svg+xml"],
          "description": "Image MIME type"
        },
        "alt_text": {
          "type": "string",
          "description": "Alternative text for accessibility"
        }
      },
      "required": ["image_base64", "width", "height"]
    },
    "data_series": {
      "$id": "#/definitions/data_series",
      "type": "object",
      "title": "Data Series Schema",
      "description": "Schema for numerical data series",
      "properties": {
        "x": {
          "type": "array",
          "items": {"type": "number"},
          "description": "X-axis data points"
        },
        "y": {
          "type": "array",
          "items": {"type": "number"},
          "description": "Y-axis data points"
        },
        "label": {
          "type": "string",
          "description": "Series label",
          "default": "Series"
        }
      },
      "required": ["x", "y"]
    },
    "ui_configuration": {
      "$id": "#/definitions/ui_configuration",
      "type": "object",
      "title": "UI Configuration Schema",
      "description": "Common UI configuration options",
      "properties": {
        "show": {
          "type": "boolean",
          "description": "Whether to show the element",
          "default": true
        },
        "theme": {
          "enum": ["default", "dark", "light", "minimal"],
          "description": "UI theme",
          "default": "default"
        },
        "size": {
          "type": "object",
          "properties": {
            "width": {"type": "integer", "minimum": 200, "maximum": 1200},
            "height": {"type": "integer", "minimum": 200, "maximum": 800}
          }
        }
      }
    }
  }
}